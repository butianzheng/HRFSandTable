# SPM Simulator æ¶æ„è®¾è®¡æ–‡æ¡£

**é¡¹ç›®**: çƒ­è½§å¹³æ•´æœºç»„æ’ç¨‹æ²™ç›˜æ¨¡æ‹Ÿç³»ç»Ÿ
**ç‰ˆæœ¬**: v1.0
**æ›´æ–°æ—¥æœŸ**: 2026-02-16
**ä½œè€…**: å¼€å‘å›¢é˜Ÿ

---

## ğŸ“‹ ç›®å½•

- [1. ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ](#1-ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ)
- [2. å‰ç«¯æ¶æ„è®¾è®¡](#2-å‰ç«¯æ¶æ„è®¾è®¡)
- [3. åç«¯æ¶æ„è®¾è®¡](#3-åç«¯æ¶æ„è®¾è®¡)
- [4. æ ¸å¿ƒç®—æ³•å¼•æ“](#4-æ ¸å¿ƒç®—æ³•å¼•æ“)
- [5. Web Workers æ¶æ„](#5-web-workers-æ¶æ„)
- [6. æ•°æ®æµè®¾è®¡](#6-æ•°æ®æµè®¾è®¡)
- [7. æŠ€æœ¯é€‰å‹](#7-æŠ€æœ¯é€‰å‹)
- [8. å…³é”®è®¾è®¡å†³ç­–](#8-å…³é”®è®¾è®¡å†³ç­–)
- [9. æœ€ä½³å®è·µ](#9-æœ€ä½³å®è·µ)

---

## 1. ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

### 1.1 æ•´ä½“æ¶æ„

SPM Simulator é‡‡ç”¨ **Tauri æ¡Œé¢åº”ç”¨æ¶æ„**ï¼Œç»“åˆ React å‰ç«¯å’Œ Rust åç«¯ï¼Œå®ç°é«˜æ€§èƒ½ã€è·¨å¹³å°çš„æ¡Œé¢åº”ç”¨ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·ç•Œé¢å±‚                              â”‚
â”‚                    (React + TypeScript)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ å·¥ä½œå°   â”‚  â”‚ é£é™©åˆ†æ â”‚  â”‚ æ–¹æ¡ˆå¯¹æ¯” â”‚  â”‚ æ•°æ®ç®¡ç† â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†• Tauri IPC
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ä¸šåŠ¡é€»è¾‘å±‚                              â”‚
â”‚                      (Rust + Tauri)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Commands â”‚  â”‚ Services â”‚  â”‚  Engine  â”‚  â”‚  Models  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®æŒä¹…å±‚                             â”‚
â”‚                    (SQLite + SeaORM)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ææ–™è¡¨   â”‚  â”‚ æ–¹æ¡ˆè¡¨   â”‚  â”‚ é…ç½®è¡¨   â”‚  â”‚ æ—¥å¿—è¡¨   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ ¸å¿ƒç‰¹æ€§

- **è·¨å¹³å°**: æ”¯æŒ Windowsã€macOSã€Linux
- **é«˜æ€§èƒ½**: Rust åç«¯å¤„ç†å¤æ‚æ’ç¨‹ç®—æ³•
- **å“åº”å¼**: React å‰ç«¯æä¾›æµç•…çš„ç”¨æˆ·ä½“éªŒ
- **ç¦»çº¿ä¼˜å…ˆ**: æœ¬åœ° SQLite æ•°æ®åº“ï¼Œæ— éœ€ç½‘ç»œè¿æ¥
- **ç±»å‹å®‰å…¨**: TypeScript + Rust åŒé‡ç±»å‹ä¿éšœ

---

## 2. å‰ç«¯æ¶æ„è®¾è®¡

### 2.1 ä¸‰å±‚æ¶æ„

å‰ç«¯é‡‡ç”¨ç»å…¸çš„ä¸‰å±‚æ¶æ„æ¨¡å¼ï¼ŒèŒè´£æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Components å±‚                           â”‚
â”‚                    (UI ç»„ä»¶ + é¡µé¢)                          â”‚
â”‚  - è´Ÿè´£UIæ¸²æŸ“å’Œç”¨æˆ·äº¤äº’                                       â”‚
â”‚  - è°ƒç”¨ Stores è·å–çŠ¶æ€                                       â”‚
â”‚  - è°ƒç”¨ Services æ‰§è¡Œä¸šåŠ¡æ“ä½œ                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Stores å±‚                              â”‚
â”‚                   (çŠ¶æ€ç®¡ç† Zustand)                         â”‚
â”‚  - ç®¡ç†å…¨å±€åº”ç”¨çŠ¶æ€                                           â”‚
â”‚  - æä¾›çŠ¶æ€æ›´æ–°æ–¹æ³•                                           â”‚
â”‚  - è°ƒç”¨ Services è·å–æ•°æ®                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Services å±‚                             â”‚
â”‚                  (API è°ƒç”¨ + ä¸šåŠ¡é€»è¾‘)                       â”‚
â”‚  - å°è£…æ‰€æœ‰ Tauri å‘½ä»¤è°ƒç”¨                                    â”‚
â”‚  - æä¾›ç»Ÿä¸€çš„ API æ¥å£                                        â”‚
â”‚  - å¤„ç†æ•°æ®è½¬æ¢å’Œé”™è¯¯å¤„ç†                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ pages/              # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ Workbench/      # å·¥ä½œå°é¡µé¢
â”‚   â”œâ”€â”€ RiskOverview/   # é£é™©åˆ†æé¡µé¢
â”‚   â”œâ”€â”€ Comparison/     # æ–¹æ¡ˆå¯¹æ¯”é¡µé¢
â”‚   â”œâ”€â”€ History/        # å†å²è¿½æº¯é¡µé¢
â”‚   â”œâ”€â”€ DataManage/     # æ•°æ®ç®¡ç†é¡µé¢
â”‚   â”œâ”€â”€ FieldMapping/   # å­—æ®µæ˜ å°„é¡µé¢
â”‚   â”œâ”€â”€ Strategy/       # ç­–ç•¥æ¨¡æ¿é¡µé¢
â”‚   â”œâ”€â”€ Settings/       # è®¾ç½®ä¸­å¿ƒé¡µé¢
â”‚   â””â”€â”€ Logs/           # æ—¥å¿—æŸ¥çœ‹é¡µé¢
â”œâ”€â”€ components/         # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ Common/         # åŸºç¡€ç»„ä»¶
â”‚   â”œâ”€â”€ DeferredEChart.tsx  # å»¶è¿ŸåŠ è½½å›¾è¡¨
â”‚   â”œâ”€â”€ ErrorBoundary.tsx   # é”™è¯¯è¾¹ç•Œ
â”‚   â””â”€â”€ MaterialTable.tsx   # ææ–™è¡¨æ ¼
â”œâ”€â”€ services/           # API æœåŠ¡å±‚
â”‚   â”œâ”€â”€ scheduleApi.ts  # æ’ç¨‹ç›¸å…³ API
â”‚   â”œâ”€â”€ configApi.ts    # é…ç½®ç›¸å…³ API
â”‚   â”œâ”€â”€ materialApi.ts  # ææ–™ç›¸å…³ API
â”‚   â””â”€â”€ logApi.ts       # æ—¥å¿—ç›¸å…³ API
â”œâ”€â”€ stores/             # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ scheduleStore.ts  # æ’ç¨‹çŠ¶æ€
â”‚   â”œâ”€â”€ materialStore.ts  # ææ–™çŠ¶æ€
â”‚   â””â”€â”€ configStore.ts    # é…ç½®çŠ¶æ€
â”œâ”€â”€ types/              # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”œâ”€â”€ hooks/              # è‡ªå®šä¹‰ Hooks
â”œâ”€â”€ routes/             # è·¯ç”±é…ç½®
â””â”€â”€ styles/             # å…¨å±€æ ·å¼
```

### 2.3 çŠ¶æ€ç®¡ç†ç­–ç•¥

ä½¿ç”¨ **Zustand** è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œä¼˜åŠ¿ï¼š

- **è½»é‡çº§**: ä½“ç§¯å°ï¼Œæ€§èƒ½å¥½
- **ç®€å•æ˜“ç”¨**: API ç®€æ´ï¼Œå­¦ä¹ æˆæœ¬ä½
- **TypeScript å‹å¥½**: å®Œæ•´çš„ç±»å‹æ”¯æŒ
- **æ— éœ€ Provider**: ç›´æ¥å¯¼å…¥ä½¿ç”¨

**çŠ¶æ€ç®¡ç†ç¤ºä¾‹**:

```typescript
// scheduleStore.ts
import { create } from 'zustand';

interface ScheduleState {
  plans: SchedulePlan[];
  currentPlan: SchedulePlan | null;
  loading: boolean;
  fetchPlans: () => Promise<void>;
  setCurrentPlan: (plan: SchedulePlan | null) => void;
}

export const useScheduleStore = create<ScheduleState>((set) => ({
  plans: [],
  currentPlan: null,
  loading: false,

  fetchPlans: async () => {
    set({ loading: true });
    try {
      const plans = await scheduleApi.getPlans();
      set({ plans, loading: false });
    } catch (error) {
      set({ loading: false });
      throw error;
    }
  },

  setCurrentPlan: (plan) => set({ currentPlan: plan }),
}));
```

### 2.4 è·¯ç”±è®¾è®¡

ä½¿ç”¨ **React Router v7** è¿›è¡Œè·¯ç”±ç®¡ç†ï¼š

```typescript
// routes/index.tsx
const routes = [
  { path: '/', element: <Workbench /> },
  { path: '/risk', element: <RiskOverview /> },
  { path: '/compare', element: <Comparison /> },
  { path: '/history', element: <History /> },
  { path: '/data', element: <DataManage /> },
  { path: '/mapping', element: <FieldMapping /> },
  { path: '/strategy', element: <Strategy /> },
  { path: '/settings', element: <Settings /> },
  { path: '/logs', element: <Logs /> },
];
```

**è·¯ç”±å‚æ•°ä¼ é€’**:
- ä½¿ç”¨ URL æŸ¥è¯¢å‚æ•°è¿›è¡Œé¡µé¢é—´æ•°æ®ä¼ é€’
- ä¾‹å¦‚: `/risk?planId=123` æˆ– `/compare?planA=1&planB=2`

### 2.5 ç»„ä»¶è®¾è®¡åŸåˆ™

1. **å•ä¸€èŒè´£**: æ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
2. **å¯å¤ç”¨æ€§**: é€šç”¨ç»„ä»¶æ”¾åœ¨ `components/` ç›®å½•
3. **Props ç±»å‹åŒ–**: æ‰€æœ‰ Props å¿…é¡»å®šä¹‰ TypeScript ç±»å‹
4. **é”™è¯¯è¾¹ç•Œ**: å…³é”®ç»„ä»¶ä½¿ç”¨ ErrorBoundary åŒ…è£¹
5. **æ€§èƒ½ä¼˜åŒ–**:
   - ä½¿ç”¨ `React.memo` é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
   - ä½¿ç”¨ `useMemo` å’Œ `useCallback` ä¼˜åŒ–è®¡ç®—å’Œå›è°ƒ
   - å¤§å‹å›¾è¡¨ä½¿ç”¨ `DeferredEChart` å»¶è¿ŸåŠ è½½

---

## 3. åç«¯æ¶æ„è®¾è®¡

### 3.1 æ¨¡å—åˆ’åˆ†

åç«¯é‡‡ç”¨åˆ†å±‚æ¶æ„ï¼ŒèŒè´£æ¸…æ™°ï¼š

```
src-tauri/src/
â”œâ”€â”€ commands/           # Tauri å‘½ä»¤å±‚ï¼ˆAPI å…¥å£ï¼‰
â”‚   â”œâ”€â”€ config/         # é…ç½®ç›¸å…³å‘½ä»¤
â”‚   â”‚   â”œâ”€â”€ strategy.rs     # ç­–ç•¥æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ priority_io/    # ä¼˜å…ˆçº§é…ç½®å¯¼å…¥å¯¼å‡º
â”‚   â”‚   â”œâ”€â”€ system.rs       # ç³»ç»Ÿé…ç½®
â”‚   â”‚   â””â”€â”€ maintenance.rs  # æ£€ä¿®è®¡åˆ’
â”‚   â””â”€â”€ schedule/       # æ’ç¨‹ç›¸å…³å‘½ä»¤
â”‚       â”œâ”€â”€ plan.rs         # æ–¹æ¡ˆç®¡ç†
â”‚       â”œâ”€â”€ schedule.rs     # æ’ç¨‹æ“ä½œ
â”‚       â”œâ”€â”€ risk.rs         # é£é™©åˆ†æ
â”‚       â””â”€â”€ comparison.rs   # æ–¹æ¡ˆå¯¹æ¯”
â”œâ”€â”€ services/           # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ material_service.rs  # ææ–™æœåŠ¡
â”‚   â”œâ”€â”€ schedule_service.rs  # æ’ç¨‹æœåŠ¡
â”‚   â””â”€â”€ config_service.rs    # é…ç½®æœåŠ¡
â”œâ”€â”€ engine/             # æ ¸å¿ƒç®—æ³•å¼•æ“
â”‚   â”œâ”€â”€ scheduler.rs         # æ’ç¨‹ç®—æ³•
â”‚   â”œâ”€â”€ evaluator.rs         # è¯„ä¼°ç®—æ³•
â”‚   â””â”€â”€ validator.rs         # éªŒè¯ç®—æ³•
â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹ï¼ˆSeaORMï¼‰
â”‚   â”œâ”€â”€ material.rs          # ææ–™æ¨¡å‹
â”‚   â”œâ”€â”€ plan.rs              # æ–¹æ¡ˆæ¨¡å‹
â”‚   â””â”€â”€ config.rs            # é…ç½®æ¨¡å‹
â”œâ”€â”€ migration/          # æ•°æ®åº“è¿ç§»
â””â”€â”€ utils/              # å·¥å…·å‡½æ•°
```

### 3.2 Commands å±‚

**èŒè´£**: ä½œä¸ºå‰ç«¯å’Œåç«¯çš„æ¡¥æ¢ï¼Œå¤„ç† Tauri IPC è°ƒç”¨

**è®¾è®¡åŸåˆ™**:
- æ¯ä¸ªå‘½ä»¤å‡½æ•°ä½¿ç”¨ `#[tauri::command]` å®æ ‡æ³¨
- å‚æ•°å’Œè¿”å›å€¼å¿…é¡»å®ç° `Serialize` å’Œ `Deserialize`
- é”™è¯¯ç»Ÿä¸€ä½¿ç”¨ `Result<T, String>` è¿”å›
- å‘½ä»¤å‡½æ•°ä¿æŒç®€æ´ï¼Œå¤æ‚é€»è¾‘å§”æ‰˜ç»™ Services å±‚

**ç¤ºä¾‹**:

```rust
#[tauri::command]
pub async fn get_plans(
    state: State<'_, AppState>,
    filter: Option<PlanFilter>,
) -> Result<Vec<SchedulePlan>, String> {
    let db = &state.db;
    schedule_service::get_plans(db, filter)
        .await
        .map_err(|e| e.to_string())
}
```

### 3.3 Services å±‚

**èŒè´£**: å®ç°æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œåè°ƒ Models å’Œ Engine

**è®¾è®¡åŸåˆ™**:
- æ¯ä¸ª Service å¯¹åº”ä¸€ä¸ªä¸šåŠ¡é¢†åŸŸ
- ä½¿ç”¨ `async/await` å¤„ç†å¼‚æ­¥æ“ä½œ
- ç»Ÿä¸€é”™è¯¯å¤„ç†ï¼Œä½¿ç”¨ `anyhow::Result`
- äº‹åŠ¡ç®¡ç†ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§

**ç¤ºä¾‹**:

```rust
pub async fn create_plan(
    db: &DatabaseConnection,
    plan: CreatePlanInput,
) -> anyhow::Result<SchedulePlan> {
    let txn = db.begin().await?;

    // åˆ›å»ºæ–¹æ¡ˆ
    let plan_model = plan::ActiveModel {
        plan_no: Set(generate_plan_no()),
        name: Set(plan.name),
        status: Set("draft".to_string()),
        ..Default::default()
    };

    let result = plan_model.insert(&txn).await?;
    txn.commit().await?;

    Ok(result.into())
}
```

### 3.4 Engine å±‚

**èŒè´£**: å®ç°æ ¸å¿ƒç®—æ³•ï¼ŒåŒ…æ‹¬æ’ç¨‹ã€è¯„ä¼°ã€éªŒè¯

**æ ¸å¿ƒç®—æ³•**:

1. **æ’ç¨‹ç®—æ³•** (`scheduler.rs`)
   - åŸºäºå¤šç»´åº¦ä¼˜å…ˆçº§çš„è‡ªåŠ¨æ’ç¨‹
   - æ”¯æŒç¡¬çº¦æŸå’Œè½¯çº¦æŸ
   - è€ƒè™‘é€‚æ¸©ã€äº¤æœŸã€æ¢è¾Šç­‰å› ç´ 

2. **è¯„ä¼°ç®—æ³•** (`evaluator.rs`)
   - è®¡ç®—æ’ç¨‹æ–¹æ¡ˆçš„ç»¼åˆå¾—åˆ†
   - è¯„ä¼°é£é™©æŒ‡æ ‡ï¼ˆå®½è·³ã€æ¢è¾Šã€é€‚æ¸©ï¼‰
   - ç”Ÿæˆè¯„ä¼°æŠ¥å‘Š

3. **éªŒè¯ç®—æ³•** (`validator.rs`)
   - éªŒè¯æ’ç¨‹æ–¹æ¡ˆçš„åˆæ³•æ€§
   - æ£€æŸ¥ç¡¬çº¦æŸè¿å
   - æä¾›ä¼˜åŒ–å»ºè®®

**è®¾è®¡åŸåˆ™**:
- ç®—æ³•ç‹¬ç«‹äºä¸šåŠ¡é€»è¾‘ï¼Œå¯å•ç‹¬æµ‹è¯•
- ä½¿ç”¨çº¯å‡½æ•°ï¼Œé¿å…å‰¯ä½œç”¨
- æ€§èƒ½ä¼˜åŒ–ï¼Œä½¿ç”¨å¹¶è¡Œè®¡ç®—ï¼ˆRayonï¼‰

### 3.5 Models å±‚

**èŒè´£**: å®šä¹‰æ•°æ®æ¨¡å‹ï¼Œæ˜ å°„æ•°æ®åº“è¡¨

ä½¿ç”¨ **SeaORM** è¿›è¡Œ ORM æ˜ å°„ï¼š

```rust
#[derive(Clone, Debug, PartialEq, DeriveEntityModel)]
#[sea_orm(table_name = "schedule_plans")]
pub struct Model {
    #[sea_orm(primary_key)]
    pub id: i32,
    pub plan_no: String,
    pub name: String,
    pub status: String,
    pub version: i32,
    pub created_at: DateTime,
    pub updated_at: DateTime,
}

#[derive(Copy, Clone, Debug, EnumIter, DeriveRelation)]
pub enum Relation {
    #[sea_orm(has_many = "super::schedule_item::Entity")]
    ScheduleItems,
}
```

### 3.6 æ•°æ®åº“è®¾è®¡

**æ ¸å¿ƒè¡¨ç»“æ„**:

1. **materials** - ææ–™è¡¨
   - å­˜å‚¨å¾…æ’ç¨‹ææ–™ä¿¡æ¯
   - åŒ…å«é’¢ç§ã€è§„æ ¼ã€å®¢æˆ·ã€äº¤æœŸç­‰å­—æ®µ

2. **schedule_plans** - æ’ç¨‹æ–¹æ¡ˆè¡¨
   - å­˜å‚¨æ’ç¨‹æ–¹æ¡ˆå…ƒæ•°æ®
   - æ”¯æŒç‰ˆæœ¬ç®¡ç†

3. **schedule_items** - æ’ç¨‹é¡¹ç›®è¡¨
   - å­˜å‚¨æ’ç¨‹æ–¹æ¡ˆä¸­çš„ææ–™é¡ºåº
   - å…³è” materials å’Œ schedule_plans

4. **strategy_templates** - ç­–ç•¥æ¨¡æ¿è¡¨
   - å­˜å‚¨æ’ç¨‹ç­–ç•¥é…ç½®
   - åŒ…å«ä¼˜å…ˆçº§æƒé‡ã€çº¦æŸæ¡ä»¶ç­‰

5. **operation_logs** - æ“ä½œæ—¥å¿—è¡¨
   - è®°å½•æ‰€æœ‰ç”¨æˆ·æ“ä½œ
   - æ”¯æŒå®¡è®¡å’Œè¿½æº¯

**æ•°æ®åº“è¿ç§»**:
- ä½¿ç”¨ SeaORM çš„ migration åŠŸèƒ½
- æ¯æ¬¡æ•°æ®åº“å˜æ›´åˆ›å»ºæ–°çš„ migration æ–‡ä»¶
- æ”¯æŒç‰ˆæœ¬å‡çº§å’Œå›æ»š

---

## 4. æ ¸å¿ƒç®—æ³•å¼•æ“

æ ¸å¿ƒç®—æ³•å¼•æ“ä½äº `src-tauri/src/engine/`ï¼Œå…± 10 ä¸ªæ–‡ä»¶ï¼Œçº¦ 2,694 è¡Œä»£ç ï¼Œè´Ÿè´£æ’ç¨‹ç³»ç»Ÿçš„æ‰€æœ‰æ™ºèƒ½è®¡ç®—ã€‚

### 4.1 8 æ­¥æ’ç¨‹ç®—æ³• (`scheduler.rs`, 365 è¡Œ)

è‡ªåŠ¨æ’ç¨‹çš„æ ¸å¿ƒæµç¨‹ï¼Œä¸¥æ ¼æŒ‰ä»¥ä¸‹ 8 ä¸ªæ­¥éª¤é¡ºåºæ‰§è¡Œï¼š

```
æ­¥éª¤ 1: æ•°æ®å‡†å¤‡ä¸éªŒè¯
         â†“  ä»æ•°æ®åº“åŠ è½½ç‰©æ–™ï¼Œæ ¡éªŒå¿…å¡«å­—æ®µ
æ­¥éª¤ 2: é€‚æ¸©çŠ¶æ€è®¡ç®—
         â†“  è°ƒç”¨ temp_calc è®¡ç®—æ¯å·çš„é€‚æ¸©åŒºé—´
æ­¥éª¤ 3: æ•°æ®é¢„å¤„ç†
         â†“  å½’ä¸€åŒ–å­—æ®µï¼Œæ„å»ºæ’ç¨‹ä¸Šä¸‹æ–‡
æ­¥éª¤ 4: 6 ç»´ä¼˜å…ˆçº§æ’åº
         â†“  è°ƒç”¨ priority å¼•æ“è®¡ç®—ç»¼åˆä¼˜å…ˆçº§åˆ†æ•°
æ­¥éª¤ 5: ç¡¬çº¦æŸæ ¡éªŒ
         â†“  è°ƒç”¨ validator è¿‡æ»¤è¿åç¡¬çº¦æŸçš„ç‰©æ–™
æ­¥éª¤ 6: æ¢è¾Šè®¡ç®—
         â†“  è°ƒç”¨ roll_change è®¡ç®—æœ€ä¼˜æ¢è¾Šæ—¶æœº
æ­¥éª¤ 7: ç­æ¬¡åˆ†é…
         â†“  æŒ‰ç­æ¬¡äº§èƒ½ä¸Šé™å°†ç‰©æ–™åˆ†é…åˆ°å„ç­æ¬¡
æ­¥éª¤ 8: æ–¹æ¡ˆè¯„ä¼°
         â†“  è°ƒç”¨ evaluator è®¡ç®— 5 ç»´ç»¼åˆè¯„åˆ†
         ç»“æœ
```

### 4.2 6 ç»´ä¼˜å…ˆçº§å¼•æ“ (`priority.rs`, 512 è¡Œ)

å¯¹æ¯å·ç‰©æ–™è®¡ç®—ç»¼åˆä¼˜å…ˆçº§åˆ†æ•°ï¼Œ6 ä¸ªç»´åº¦æƒé‡å¯åœ¨"è®¾ç½®ä¸­å¿ƒ"é…ç½®ï¼š

| ç»´åº¦ | é…ç½®è¡¨ | è¯´æ˜ |
|------|--------|------|
| **åˆåŒè€ƒæ ¸** | `priority_weight_configs` | åŸºäºåˆåŒè€ƒæ ¸æ ‡è®°çš„åˆ†å€¼ |
| **äº¤æœŸå±æ€§** | `priority_dimension_configs` | æŒ‰äº¤æœŸç´§è¿«ç¨‹åº¦åˆ†æ¡£ï¼ˆè¶…æœŸ/3å¤©/7å¤©å†…/è¾ƒè¿œï¼‰ |
| **åˆåŒå±æ€§** | `priority_dimension_configs` | æŒ‰åˆåŒæ€§è´¨åˆ†ç±»ï¼ˆå‡ºå£/å†…é”€/è¯•åˆ¶ç­‰ï¼‰ |
| **å®¢æˆ·ä¼˜å…ˆçº§** | `customer_priority_configs` | æŒ‰å®¢æˆ·ä»£ç é…ç½®ä¼˜å…ˆçº§ |
| **é›†æ‰¹ä¼˜å…ˆçº§** | `batch_priority_configs` | æŒ‰é›†æ‰¹ä»£ç é…ç½®ä¼˜å…ˆçº§ |
| **äº§å“å¤§ç±»** | `product_type_priority_configs` | æŒ‰é’¢ç§/äº§å“ç±»å‹é…ç½®ä¼˜å…ˆçº§ |

æœ€ç»ˆåˆ†æ•° = Î£(å„ç»´åº¦å¾—åˆ† Ã— å¯¹åº”æƒé‡)

### 4.3 5 ç»´æ–¹æ¡ˆè¯„ä¼°å¼•æ“ (`evaluator.rs`, 331 è¡Œ)

å¯¹å®Œæ•´æ’ç¨‹åºåˆ—è®¡ç®—ç»¼åˆè´¨é‡è¯„åˆ†ï¼ˆæ»¡åˆ† 100ï¼‰ï¼š

| è¯„ä¼°ç»´åº¦ | æƒé‡ | è®¡ç®—é€»è¾‘ |
|----------|------|----------|
| **å®½åº¦è·³è·ƒ** | 30% | ç›¸é‚»å·å®½åº¦å·®è¶Šå°å¾—åˆ†è¶Šé«˜ |
| **æ¢è¾Šæ¬¡æ•°** | 25% | æ¢è¾Šé¢‘ç‡è¶Šä½å¾—åˆ†è¶Šé«˜ |
| **äº§èƒ½åˆ©ç”¨ç‡** | 20% | ç­æ¬¡äº§èƒ½å……æ»¡åº¦è¶Šé«˜å¾—åˆ†è¶Šé«˜ |
| **é€‚æ¸©ç‡** | 15% | é€‚æ¸©å·æ¯”ä¾‹è¶Šé«˜å¾—åˆ†è¶Šé«˜ |
| **ç´§æ€¥å®Œæˆç‡** | 10% | è¶…æœŸ/ç´§æ€¥å·æ’å…¥è¶Šå¤šå¾—åˆ†è¶Šé«˜ |

### 4.4 çº¦æŸéªŒè¯å™¨ (`validator.rs`, 664 è¡Œ)

åˆ†ä¸¤ç±»çº¦æŸè¿›è¡ŒéªŒè¯ï¼š

- **ç¡¬çº¦æŸï¼ˆHard Constraintsï¼‰**: è¿åå³ä¸å¯æ’å…¥ï¼Œå¦‚å®½åº¦è¶…é™ã€é’¢ç§ä¸å…¼å®¹ã€è®¾å¤‡èƒ½åŠ›é™åˆ¶ç­‰
- **è½¯çº¦æŸï¼ˆSoft Constraintsï¼‰**: è¿åä¼šäº§ç”Ÿé£é™©å‘Šè­¦ï¼ˆhigh/medium/lowï¼‰ï¼Œå¦‚å®½åº¦è·³è·ƒè¿‡å¤§ã€äº¤æœŸç´§è¿«ç­‰

éªŒè¯ç»“æœé€šè¿‡ `evaluate_risks` å‘½ä»¤è¿”å› `RiskAnalysis`ï¼ŒåŒ…å«æ¯æ¡è¿åè®°å½•å’Œä¿®å¤å»ºè®®ã€‚

### 4.5 å…¶ä»–ç®—æ³•æ¨¡å—

| æ¨¡å— | æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|------|
| æ¢è¾Šè®¡ç®— | `roll_change.rs` | æ ¹æ®ç´¯è®¡å¨ä½ã€é’¢ç§åˆ‡æ¢ç­‰æ¡ä»¶åˆ¤æ–­æ¢è¾Šæ—¶æœº |
| é€‚æ¸©è®¡ç®— | `temp_calc.rs` | åŸºäºå·å–äº§å‡ºæ—¶é—´è®¡ç®—å„å·çš„é€‚æ¸©çŠ¶æ€ï¼ˆé€‚æ¸©/å¾…æ¸©ï¼‰ |
| æ’åºå™¨ | `sorter.rs` | å¤šé”®æ’åºç®—æ³•ï¼Œæ”¯æŒä¼˜å…ˆçº§ã€äº¤æœŸã€å®½åº¦ç­‰ç»„åˆæ’åº |
| å¼•æ“å¸¸é‡ | `constants.rs` | æœ€å¤§å®½åº¦è·³è·ƒã€ç­æ¬¡äº§èƒ½ç­‰å·¥è‰ºå‚æ•°å¸¸é‡ |

---

## 5. Web Workers æ¶æ„

ä¸ºäº†ä¿æŒ UI å“åº”æµç•…ï¼Œ3 ä¸ªé‡è®¡ç®—ä»»åŠ¡è¢«ç§»åˆ° Web Workers ä¸­å¼‚æ­¥æ‰§è¡Œï¼š

```
ä¸»çº¿ç¨‹ (React)                    Worker çº¿ç¨‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
usePriorityHit â”€â”€postMessageâ”€â”€â†’  priorityHit.worker.ts
                                  â”œâ”€ è®¡ç®—æ¯è¡Œç‰©æ–™å‘½ä¸­çš„ä¼˜å…ˆçº§è§„åˆ™
                â†â”€â”€onMessageâ”€â”€â”€â”€  è¿”å›å‘½ä¸­ç»“æœï¼Œç”¨äºé«˜äº®å±•ç¤º

useRiskConfigHit â”€postMessageâ”€â”€â†’ riskConfigHit.worker.ts
                                  â”œâ”€ è®¡ç®—æ¯è¡Œç‰©æ–™å‘½ä¸­çš„é£é™©é…ç½®
                â†â”€â”€onMessageâ”€â”€â”€â”€  è¿”å›å‘½ä¸­ç»“æœï¼Œç”¨äºé£é™©æ ‡è®°

Logs é¡µé¢ â”€â”€â”€â”€â”€â”€â”€â”€postMessageâ”€â”€â†’ logFilter.worker.ts
                                  â”œâ”€ åœ¨å¤§é‡æ—¥å¿—ä¸­è¿›è¡Œå¤šæ¡ä»¶è¿‡æ»¤
                â†â”€â”€onMessageâ”€â”€â”€â”€  è¿”å›è¿‡æ»¤åçš„æ—¥å¿—åˆ—è¡¨
```

**Worker ä½ç½®**: `src/workers/`
- `priorityHit.worker.ts` - ä¼˜å…ˆçº§è§„åˆ™å‘½ä¸­è®¡ç®—
- `riskConfigHit.worker.ts` - é£é™©é…ç½®å‘½ä¸­è®¡ç®—
- `logFilter.worker.ts` - æ—¥å¿—å¤šæ¡ä»¶è¿‡æ»¤

**è§¦å‘æ–¹å¼**: é€šè¿‡ `usePriorityHit` Hookï¼ˆä½äº `src/pages/Workbench/`ï¼‰é›†æˆï¼Œæ¯å½“æ’ç¨‹æ•°æ®æˆ–ä¼˜å…ˆçº§é…ç½®å˜åŒ–æ—¶è‡ªåŠ¨è§¦å‘é‡æ–°è®¡ç®—ã€‚

---

## 6. æ•°æ®æµè®¾è®¡

### 6.1 å…¸å‹æ•°æ®æµ

ä»¥"è‡ªåŠ¨æ’ç¨‹"ä¸ºä¾‹ï¼Œå±•ç¤ºå®Œæ•´çš„æ•°æ®æµï¼š

```
1. ç”¨æˆ·æ“ä½œ
   â†“
2. React ç»„ä»¶è°ƒç”¨ scheduleApi.autoSchedule()
   â†“
3. scheduleApi é€šè¿‡ Tauri invoke è°ƒç”¨åç«¯å‘½ä»¤
   â†“
4. Commands å±‚æ¥æ”¶è¯·æ±‚ï¼Œè°ƒç”¨ Services å±‚
   â†“
5. Services å±‚è°ƒç”¨ Engine å±‚æ‰§è¡Œæ’ç¨‹ç®—æ³•
   â†“
6. Engine å±‚ä» Models å±‚è¯»å–æ•°æ®
   â†“
7. Engine å±‚è®¡ç®—æ’ç¨‹ç»“æœ
   â†“
8. Services å±‚å°†ç»“æœä¿å­˜åˆ°æ•°æ®åº“
   â†“
9. Commands å±‚è¿”å›ç»“æœç»™å‰ç«¯
   â†“
10. scheduleApi æ›´æ–° Store çŠ¶æ€
   â†“
11. React ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œå±•ç¤ºç»“æœ
```

### 6.2 çŠ¶æ€åŒæ­¥

**å‰ç«¯çŠ¶æ€åŒæ­¥ç­–ç•¥**:

1. **ä¹è§‚æ›´æ–°**:
   - ç”¨æˆ·æ“ä½œç«‹å³æ›´æ–° UI
   - åå°å¼‚æ­¥è°ƒç”¨ API
   - å¤±è´¥æ—¶å›æ»šçŠ¶æ€

2. **ç¼“å­˜ç­–ç•¥**:
   - Services å±‚å®ç°ç®€å•çš„å†…å­˜ç¼“å­˜
   - ç¼“å­˜é”®åŸºäºè¯·æ±‚å‚æ•°
   - æ•°æ®å˜æ›´æ—¶æ¸…é™¤ç›¸å…³ç¼“å­˜

3. **è½®è¯¢æ›´æ–°**:
   - é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ä½¿ç”¨è½®è¯¢
   - å®šæœŸæŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
   - å®Œæˆåæ›´æ–° UI

### 6.3 é”™è¯¯å¤„ç†

**åˆ†å±‚é”™è¯¯å¤„ç†**:

1. **åç«¯é”™è¯¯å¤„ç†**:
   ```rust
   // ä½¿ç”¨ anyhow ç»Ÿä¸€é”™è¯¯ç±»å‹
   pub async fn some_operation() -> anyhow::Result<T> {
       // ä¸šåŠ¡é€»è¾‘
       Ok(result)
   }

   // Commands å±‚è½¬æ¢ä¸ºå­—ç¬¦ä¸²é”™è¯¯
   #[tauri::command]
   pub async fn command() -> Result<T, String> {
       some_operation()
           .await
           .map_err(|e| e.to_string())
   }
   ```

2. **å‰ç«¯é”™è¯¯å¤„ç†**:
   ```typescript
   try {
       await scheduleApi.autoSchedule(planId, strategyId);
       message.success('æ’ç¨‹æˆåŠŸ');
   } catch (error) {
       message.error(`æ’ç¨‹å¤±è´¥: ${error}`);
       console.error(error);
   }
   ```

3. **å…¨å±€é”™è¯¯è¾¹ç•Œ**:
   - ä½¿ç”¨ ErrorBoundary æ•è· React ç»„ä»¶é”™è¯¯
   - æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯é¡µé¢
   - è®°å½•é”™è¯¯æ—¥å¿—

---

## 7. æŠ€æœ¯é€‰å‹

### 7.1 ä¸ºä»€ä¹ˆé€‰æ‹© Tauri

**ä¼˜åŠ¿**:
1. **ä½“ç§¯å°**: æ‰“åŒ…ä½“ç§¯æ¯” Electron å° 10 å€ä»¥ä¸Š
2. **æ€§èƒ½å¥½**: Rust åç«¯æ€§èƒ½ä¼˜å¼‚
3. **å®‰å…¨æ€§é«˜**: Rust å†…å­˜å®‰å…¨ä¿éšœ
4. **è·¨å¹³å°**: æ”¯æŒ Windowsã€macOSã€Linux
5. **Web æŠ€æœ¯æ ˆ**: å‰ç«¯ä½¿ç”¨ç†Ÿæ‚‰çš„ React

**é€‚ç”¨åœºæ™¯**:
- éœ€è¦é«˜æ€§èƒ½è®¡ç®—çš„æ¡Œé¢åº”ç”¨
- å¯¹å®‰å…¨æ€§æœ‰è¾ƒé«˜è¦æ±‚
- éœ€è¦è®¿é—®ç³»ç»Ÿåº•å±‚ API
- å¸Œæœ›å‡å°åº”ç”¨ä½“ç§¯

### 7.2 ä¸ºä»€ä¹ˆé€‰æ‹© Zustand

**ä¼˜åŠ¿**:
1. **è½»é‡çº§**: ä»… 1KB gzipped
2. **ç®€å•æ˜“ç”¨**: API ç®€æ´ï¼Œæ— éœ€ Provider
3. **TypeScript å‹å¥½**: å®Œæ•´çš„ç±»å‹æ¨å¯¼
4. **æ€§èƒ½å¥½**: åŸºäº React hooksï¼Œé¿å…ä¸å¿…è¦çš„æ¸²æŸ“
5. **çµæ´»**: æ”¯æŒä¸­é—´ä»¶ã€æŒä¹…åŒ–ç­‰æ‰©å±•

**å¯¹æ¯”å…¶ä»–æ–¹æ¡ˆ**:
- **vs Redux**: æ›´ç®€å•ï¼Œæ— éœ€ actions/reducers
- **vs Context API**: æ€§èƒ½æ›´å¥½ï¼Œé¿å… Provider åµŒå¥—
- **vs MobX**: æ›´è½»é‡ï¼Œå­¦ä¹ æˆæœ¬æ›´ä½

### 7.3 ä¸ºä»€ä¹ˆé€‰æ‹© SeaORM

**ä¼˜åŠ¿**:
1. **å¼‚æ­¥ä¼˜å…ˆ**: åŸºäº async/awaitï¼Œæ€§èƒ½å¥½
2. **ç±»å‹å®‰å…¨**: ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
3. **åŠŸèƒ½å®Œæ•´**: æ”¯æŒå…³ç³»ã€äº‹åŠ¡ã€è¿ç§»
4. **æ•°æ®åº“æ— å…³**: æ”¯æŒ SQLiteã€PostgreSQLã€MySQL
5. **æ´»è·ƒç»´æŠ¤**: ç¤¾åŒºæ´»è·ƒï¼Œæ›´æ–°é¢‘ç¹

**é€‚ç”¨åœºæ™¯**:
- Rust å¼‚æ­¥åº”ç”¨
- éœ€è¦ç±»å‹å®‰å…¨çš„ ORM
- æ”¯æŒå¤šç§æ•°æ®åº“

### 7.4 å…¶ä»–æŠ€æœ¯é€‰å‹

| æŠ€æœ¯ | é€‰å‹ | ç†ç”± |
|------|------|------|
| UI ç»„ä»¶åº“ | Ant Design 6.3 | ç»„ä»¶ä¸°å¯Œï¼Œæ–‡æ¡£å®Œå–„ï¼Œä¼ä¸šçº§ |
| å›¾è¡¨åº“ | ECharts 6.0 | åŠŸèƒ½å¼ºï¿½ï¿½ï¼Œæ€§èƒ½å¥½ï¼Œæ”¯æŒå¤§æ•°æ®é‡ |
| æµ‹è¯•æ¡†æ¶ | Vitest 4.0 | å¿«é€Ÿï¼Œä¸ Vite é›†æˆå¥½ |
| E2E æµ‹è¯• | Playwright 1.58 | è·¨æµè§ˆå™¨ï¼ŒAPI å‹å¥½ |
| æ„å»ºå·¥å…· | Vite 7.3 | å¿«é€Ÿï¼ŒHMR ä½“éªŒå¥½ |
| è·¯ç”± | React Router 7.13 | åŠŸèƒ½å®Œæ•´ï¼Œç¤¾åŒºæˆç†Ÿ |

---

## 8. å…³é”®è®¾è®¡å†³ç­–

### 8.1 ä¸ºä»€ä¹ˆä½¿ç”¨æœ¬åœ°æ•°æ®åº“è€Œéäº‘ç«¯

**å†³ç­–**: ä½¿ç”¨ SQLite æœ¬åœ°æ•°æ®åº“

**ç†ç”±**:
1. **ç¦»çº¿ä¼˜å…ˆ**: æ— éœ€ç½‘ç»œè¿æ¥å³å¯ä½¿ç”¨
2. **æ•°æ®éšç§**: æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä¸ä¸Šä¼ äº‘ç«¯
3. **æ€§èƒ½å¥½**: æ— ç½‘ç»œå»¶è¿Ÿ
4. **ç®€å•éƒ¨ç½²**: æ— éœ€é…ç½®æœåŠ¡å™¨

**æƒè¡¡**:
- ç¼ºç‚¹: æ— æ³•å¤šè®¾å¤‡åŒæ­¥
- ç¼“è§£: æä¾›æ•°æ®å¯¼å‡º/å¯¼å…¥åŠŸèƒ½

### 8.2 ä¸ºä»€ä¹ˆå‰åç«¯åˆ†ç¦»

**å†³ç­–**: å‰ç«¯ React + åç«¯ Rust åˆ†ç¦»æ¶æ„

**ç†ç”±**:
1. **èŒè´£æ¸…æ™°**: å‰ç«¯è´Ÿè´£ UIï¼Œåç«¯è´Ÿè´£ä¸šåŠ¡é€»è¾‘
2. **æŠ€æœ¯ä¼˜åŠ¿**: React æ“…é•¿ UIï¼ŒRust æ“…é•¿æ€§èƒ½è®¡ç®—
3. **å¯æµ‹è¯•æ€§**: å‰åç«¯å¯ç‹¬ç«‹æµ‹è¯•
4. **å¯ç»´æŠ¤æ€§**: ä»£ç ç»„ç»‡æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤

### 8.3 ä¸ºä»€ä¹ˆä½¿ç”¨ä¸‰å±‚æ¶æ„

**å†³ç­–**: Components / Stores / Services ä¸‰å±‚æ¶æ„

**ç†ç”±**:
1. **èŒè´£åˆ†ç¦»**: æ¯å±‚èŒè´£æ˜ç¡®
2. **å¯æµ‹è¯•æ€§**: æ¯å±‚å¯ç‹¬ç«‹æµ‹è¯•
3. **å¯å¤ç”¨æ€§**: Services å’Œ Stores å¯åœ¨å¤šä¸ªç»„ä»¶ä¸­å¤ç”¨
4. **å¯ç»´æŠ¤æ€§**: ä¿®æ”¹æŸå±‚ä¸å½±å“å…¶ä»–å±‚

### 8.4 ä¸ºä»€ä¹ˆä½¿ç”¨ Forks æ¨¡å¼è¿è¡Œæµ‹è¯•

**å†³ç­–**: Vitest ä½¿ç”¨ forks æ¨¡å¼

**ç†ç”±**:
1. **ç¨³å®šæ€§**: é¿å…æµ‹è¯•é—´çš„çŠ¶æ€æ±¡æŸ“
2. **å¹¶è¡Œæ€§**: æ”¯æŒå¤šè¿›ç¨‹å¹¶è¡Œæ‰§è¡Œ
3. **å…¼å®¹æ€§**: ä¸ jsdom ç¯å¢ƒå…¼å®¹æ€§å¥½

**æƒè¡¡**:
- ç¼ºç‚¹: å¯åŠ¨å¼€é”€ç•¥å¤§
- ä¼˜ç‚¹: æµ‹è¯•ç¨³å®šæ€§æ›´é«˜

---

## 9. æœ€ä½³å®è·µ

### 9.1 å‰ç«¯æœ€ä½³å®è·µ

1. **ç»„ä»¶è®¾è®¡**:
   - ä¿æŒç»„ä»¶å°è€Œä¸“æ³¨
   - ä½¿ç”¨ TypeScript å®šä¹‰ Props ç±»å‹
   - ä½¿ç”¨ React.memo ä¼˜åŒ–æ€§èƒ½

2. **çŠ¶æ€ç®¡ç†**:
   - å…¨å±€çŠ¶æ€æ”¾åœ¨ Stores
   - å±€éƒ¨çŠ¶æ€ä½¿ç”¨ useState
   - é¿å…è¿‡åº¦ä½¿ç”¨å…¨å±€çŠ¶æ€

3. **API è°ƒç”¨**:
   - ç»Ÿä¸€åœ¨ Services å±‚å°è£…
   - ä½¿ç”¨ try-catch å¤„ç†é”™è¯¯
   - æä¾›å‹å¥½çš„é”™è¯¯æç¤º

4. **æ€§èƒ½ä¼˜åŒ–**:
   - ä½¿ç”¨ useMemo ç¼“å­˜è®¡ç®—ç»“æœ
   - ä½¿ç”¨ useCallback ç¼“å­˜å›è°ƒå‡½æ•°
   - å¤§åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨

### 9.2 åç«¯æœ€ä½³å®è·µ

1. **é”™è¯¯å¤„ç†**:
   - ä½¿ç”¨ `anyhow::Result` ç»Ÿä¸€é”™è¯¯ç±»å‹
   - æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
   - è®°å½•é”™è¯¯æ—¥å¿—

2. **æ•°æ®åº“æ“ä½œ**:
   - ä½¿ç”¨äº‹åŠ¡ä¿è¯æ•°æ®ä¸€è‡´æ€§
   - é¿å… N+1 æŸ¥è¯¢é—®é¢˜
   - ä½¿ç”¨ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½

3. **å¹¶å‘å¤„ç†**:
   - ä½¿ç”¨ `async/await` å¤„ç†å¼‚æ­¥æ“ä½œ
   - ä½¿ç”¨ Tokio è¿è¡Œæ—¶
   - é¿å…é˜»å¡æ“ä½œ

4. **æµ‹è¯•**:
   - ä¸ºæ ¸å¿ƒç®—æ³•ç¼–å†™å•å…ƒæµ‹è¯•
   - ä½¿ç”¨ Mock éš”ç¦»å¤–éƒ¨ä¾èµ–
   - ä¿æŒæµ‹è¯•è¦†ç›–ç‡ > 80%

### 9.3 ä»£ç è§„èŒƒ

1. **å‘½åè§„èŒƒ**:
   - TypeScript: camelCase (å˜é‡/å‡½æ•°), PascalCase (ç±»/ç»„ä»¶)
   - Rust: snake_case (å˜é‡/å‡½æ•°), PascalCase (ç±»å‹/trait)

2. **æ–‡ä»¶ç»„ç»‡**:
   - ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªç»„ä»¶/æ¨¡å—
   - ç›¸å…³æ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•
   - ä½¿ç”¨ index.ts å¯¼å‡ºå…¬å…±æ¥å£

3. **æ³¨é‡Šè§„èŒƒ**:
   - å¤æ‚é€»è¾‘æ·»åŠ æ³¨é‡Š
   - å…¬å…± API æ·»åŠ æ–‡æ¡£æ³¨é‡Š
   - é¿å…æ— æ„ä¹‰çš„æ³¨é‡Š

### 9.4 Git å·¥ä½œæµ

1. **åˆ†æ”¯ç­–ç•¥**:
   - `main`: ä¸»åˆ†æ”¯ï¼Œä¿æŒç¨³å®š
   - `develop`: å¼€å‘åˆ†æ”¯
   - `feature/*`: åŠŸèƒ½åˆ†æ”¯
   - `fix/*`: ä¿®å¤åˆ†æ”¯

2. **æäº¤è§„èŒƒ**:
   ```
   feat: æ–°åŠŸèƒ½
   fix: ä¿®å¤ bug
   docs: æ–‡æ¡£æ›´æ–°
   style: ä»£ç æ ¼å¼è°ƒæ•´
   refactor: é‡æ„
   test: æµ‹è¯•ç›¸å…³
   chore: æ„å»º/å·¥å…·é“¾ç›¸å…³
   ```

3. **ä»£ç å®¡æŸ¥**:
   - æ‰€æœ‰ä»£ç å¿…é¡»ç»è¿‡ Code Review
   - è‡³å°‘ä¸€äºº Approve æ‰èƒ½åˆå¹¶
   - ä¿æŒ PR å°è€Œä¸“æ³¨

---

## é™„å½•

### A. å‚è€ƒèµ„æ–™

- [Tauri å®˜æ–¹æ–‡æ¡£](https://tauri.app/)
- [React å®˜æ–¹æ–‡æ¡£](https://react.dev/)
- [Zustand æ–‡æ¡£](https://github.com/pmndrs/zustand)
- [SeaORM æ–‡æ¡£](https://www.sea-ql.org/SeaORM/)
- [Ant Design æ–‡æ¡£](https://ant.design/)

### B. æ›´æ–°æ—¥å¿—

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|----------|
| v1.0 | 2026-02-16 | åˆå§‹ç‰ˆæœ¬ï¼Œå®Œæ•´æ¶æ„è®¾è®¡æ–‡æ¡£ |

---

**æ–‡æ¡£ç»´æŠ¤**: å¼€å‘å›¢é˜Ÿ
**æœ€åæ›´æ–°**: 2026-02-16
