# å¯¼å…¥ææ–™åŠŸèƒ½ä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°

**é—®é¢˜**: å·¥ä½œå°å¯¼å…¥ææ–™æŒ‰é’®å¼¹çª—åï¼Œç‚¹å‡»"é€‰æ‹©æ–‡ä»¶"æŒ‰é’®æ— ååº”ï¼Œå¯¼è‡´æ— æ³•å¯¼å…¥æµ‹è¯•æ•°æ®ã€‚

**æ ¹æœ¬åŸå› **:
1. æ–‡ä»¶é€‰æ‹©åŠŸèƒ½ä½¿ç”¨äº† Tauri çš„ `@tauri-apps/plugin-dialog` æ’ä»¶
2. ç¼ºå°‘é”™è¯¯å¤„ç†æœºåˆ¶
3. åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹è¿è¡Œæ—¶ï¼Œdialog æ’ä»¶æ— æ³•åŠ è½½ï¼Œå¯¼è‡´æ— å£°å¤±è´¥

## âœ… ä¿®å¤å†…å®¹

### ä¿®å¤çš„æ–‡ä»¶

1. **useScheduleOperations.ts** (å·¥ä½œå°é¡µé¢)
   - ä¿®å¤äº† `handlePickImportFile` å‡½æ•° - æ·»åŠ äº† try-catch é”™è¯¯å¤„ç†
   - ä¿®å¤äº† `handleExportPlan` å‡½æ•° - æ·»åŠ äº† try-catch é”™è¯¯å¤„ç†
   - æ”¹ä¸ºåŠ¨æ€å¯¼å…¥ dialog æ’ä»¶ï¼Œé¿å…æµè§ˆå™¨ç¯å¢ƒåŠ è½½å¤±è´¥

2. **useDataManage.ts** (æ•°æ®ç®¡ç†é¡µé¢)
   - ç§»é™¤äº†é¡¶éƒ¨çš„é™æ€å¯¼å…¥ `import { save, open } from '@tauri-apps/plugin-dialog'`
   - ä¿®å¤äº† `handleExportMaterials` å‡½æ•° - æ”¹ä¸ºåŠ¨æ€å¯¼å…¥å¹¶æ·»åŠ é”™è¯¯å¤„ç†
   - ä¿®å¤äº† `handleExportPlan` å‡½æ•° - æ”¹ä¸ºåŠ¨æ€å¯¼å…¥å¹¶æ·»åŠ é”™è¯¯å¤„ç†
   - ä¿®å¤äº† `handleRestoreFromFile` å‡½æ•° - æ”¹ä¸ºåŠ¨æ€å¯¼å…¥å¹¶æ·»åŠ é”™è¯¯å¤„ç†

### ä¸»è¦æ”¹è¿›

#### ä¿®å¤å‰ âŒ
```typescript
const handlePickImportFile = useCallback(async () => {
  const { open } = await import('@tauri-apps/plugin-dialog');
  const selected = await open({
    multiple: false,
    filters: [{ name: 'Excel/CSV', extensions: ['xlsx', 'xls', 'csv'] }],
  });
  if (typeof selected === 'string') params.setImportFilePath(selected);
}, [params]);
```

#### ä¿®å¤å âœ…
```typescript
const handlePickImportFile = useCallback(async () => {
  try {
    const { open } = await import('@tauri-apps/plugin-dialog');
    const selected = await open({
      multiple: false,
      filters: [{ name: 'Excel/CSV', extensions: ['xlsx', 'xls', 'csv'] }],
    });
    if (typeof selected === 'string') {
      params.setImportFilePath(selected);
    }
  } catch (error: unknown) {
    console.error('Failed to open file dialog:', error);
    message.error('æ— æ³•æ‰“å¼€æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼Œè¯·ç¡®ä¿åº”ç”¨è¿è¡Œåœ¨ Tauri ç¯å¢ƒä¸­');
  }
}, [params]);
```

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. éªŒè¯åº”ç”¨å·²æ›´æ–°

ç”±äºåº”ç”¨æ”¯æŒçƒ­é‡è½½ï¼ˆHMRï¼‰ï¼Œä»£ç ä¿®æ”¹å·²è‡ªåŠ¨ç”Ÿæ•ˆã€‚å¯ä»¥åœ¨æµè§ˆå™¨æ§åˆ¶å°çœ‹åˆ°ä»¥ä¸‹æ—¥å¿—ï¼š

```
[vite] (client) hmr update /src/pages/Workbench/index.tsx
[vite] (client) hmr update /src/pages/DataManage/index.tsx
```

### 2. æµ‹è¯•å¯¼å…¥ææ–™åŠŸèƒ½

#### æ–¹æ³•ä¸€ï¼šåœ¨å·¥ä½œå°é¡µé¢æµ‹è¯•

1. æ‰“å¼€åº”ç”¨ï¼šhttp://localhost:5173/
2. å¯¼èˆªåˆ° **å·¥ä½œå°** é¡µé¢
3. ç‚¹å‡»é¡¶éƒ¨å·¥å…·æ çš„ **å¯¼å…¥ææ–™** æŒ‰é’®
4. åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œç‚¹å‡» **é€‰æ‹©æ–‡ä»¶** æŒ‰é’®
5. **é¢„æœŸç»“æœ**:
   - âœ… å¦‚æœåœ¨ Tauri æ¡Œé¢åº”ç”¨ä¸­ï¼šä¼šæ‰“å¼€æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†
   - âš ï¸ å¦‚æœåœ¨æµè§ˆå™¨ä¸­ï¼šä¼šæ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤º "æ— æ³•æ‰“å¼€æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼Œè¯·ç¡®ä¿åº”ç”¨è¿è¡Œåœ¨ Tauri ç¯å¢ƒä¸­"

#### æ–¹æ³•äºŒï¼šåœ¨æ•°æ®ç®¡ç†é¡µé¢æµ‹è¯•

1. å¯¼èˆªåˆ° **æ•°æ®ç®¡ç†** é¡µé¢
2. æŸ¥çœ‹ææ–™åˆ—è¡¨åŒºåŸŸï¼ˆå½“å‰åº”è¯¥æ˜¯ç©ºçš„ï¼‰
3. ç±»ä¼¼çš„å¯¼å…¥åŠŸèƒ½ä¹Ÿåº”è¯¥æ­£å¸¸å·¥ä½œ

### 3. å¯¼å…¥æµ‹è¯•æ•°æ®

é€‰æ‹©ä¹‹å‰ç”Ÿæˆçš„æµ‹è¯•æ•°æ®æ–‡ä»¶ï¼š

```
/Users/butianzheng/Documents/trae_projects/HRFSandTable/spm-simulator/test-data-50.csv
```

æˆ–ä½¿ç”¨å…¶ä»–æµ‹è¯•æ–‡ä»¶ï¼š
- `test-data-100.csv` (100æ¡æ•°æ®)
- `test-data-500.csv` (500æ¡æ•°æ®)

### 4. éªŒè¯å¯¼å…¥æˆåŠŸ

å¯¼å…¥æˆåŠŸååº”è¯¥çœ‹åˆ°ï¼š
- âœ… æˆåŠŸæç¤ºæ¶ˆæ¯
- âœ… ææ–™åˆ—è¡¨æ˜¾ç¤ºå¯¼å…¥çš„æ•°æ®
- âœ… å¯ä»¥æŸ¥çœ‹ææ–™è¯¦æƒ…
- âœ… å¯ä»¥è¿›è¡Œæ’åºã€ç­›é€‰ç­‰æ“ä½œ

## ğŸ“ æ³¨æ„äº‹é¡¹

### Tauri æ¡Œé¢åº”ç”¨ vs æµè§ˆå™¨

**é‡è¦**: æ­¤åº”ç”¨è®¾è®¡ä¸º Tauri æ¡Œé¢åº”ç”¨ï¼Œæ–‡ä»¶é€‰æ‹©åŠŸèƒ½ä¾èµ– Tauri çš„åŸç”Ÿèƒ½åŠ›ã€‚

- **åœ¨ Tauri æ¡Œé¢åº”ç”¨ä¸­è¿è¡Œ** âœ…
  - æ–‡ä»¶é€‰æ‹©åŠŸèƒ½æ­£å¸¸
  - å¯ä»¥å¯¼å…¥ Excel/CSV æ–‡ä»¶
  - å¯ä»¥å¯¼å‡ºæ–‡ä»¶

- **åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ** âš ï¸
  - æ–‡ä»¶é€‰æ‹©åŠŸèƒ½ä¸å¯ç”¨ï¼ˆè¿™æ˜¯é¢„æœŸè¡Œä¸ºï¼‰
  - ä¼šæ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤º
  - å…¶ä»–ä¸ä¾èµ–æ–‡ä»¶ç³»ç»Ÿçš„åŠŸèƒ½ä»å¯æ­£å¸¸ä½¿ç”¨

### å¯åŠ¨æ¡Œé¢åº”ç”¨

å¦‚æœå½“å‰åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œæƒ³ä½¿ç”¨å®Œæ•´åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ Tauri æ¡Œé¢åº”ç”¨ï¼š

```bash
cd /Users/butianzheng/Documents/trae_projects/HRFSandTable/spm-simulator
npm run tauri dev
```

æ¡Œé¢åº”ç”¨ä¼šè‡ªåŠ¨æ‰“å¼€ä¸€ä¸ªåŸç”Ÿçª—å£ã€‚

## ğŸ¯ ä¿®å¤æ•ˆæœ

### ä¿®å¤å‰
- âŒ ç‚¹å‡»"é€‰æ‹©æ–‡ä»¶"æŒ‰é’®æ— ä»»ä½•ååº”
- âŒ æ— é”™è¯¯æç¤º
- âŒ ç”¨æˆ·ä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆ

### ä¿®å¤å
- âœ… åœ¨ Tauri ç¯å¢ƒä¸­æ­£å¸¸æ‰“å¼€æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†
- âœ… åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤º
- âœ… æ§åˆ¶å°è®°å½•è¯¦ç»†çš„é”™è¯¯æ—¥å¿—ï¼Œæ–¹ä¾¿è°ƒè¯•
- âœ… ç”¨æˆ·ä½“éªŒå¤§å¹…æ”¹å–„

## ğŸ” ç›¸å…³æ–‡ä»¶

ä¿®å¤æ¶‰åŠçš„æ–‡ä»¶ï¼š
- [useScheduleOperations.ts](src/pages/Workbench/useScheduleOperations.ts)
- [useDataManage.ts](src/pages/DataManage/useDataManage.ts)

æµ‹è¯•æ•°æ®æ–‡ä»¶ï¼š
- [test-data-50.csv](test-data-50.csv)
- [test-data-100.csv](test-data-100.csv)
- [test-data-500.csv](test-data-500.csv)
- [TEST-DATA-README.md](TEST-DATA-README.md)

---

**ä¿®å¤å®Œæˆæ—¶é—´**: 2026-02-16 03:24
**ä¿®å¤çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶çƒ­é‡è½½ç”Ÿæ•ˆ
